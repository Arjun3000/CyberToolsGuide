
# Nmap Vulnerability Finding Guide

## ðŸš€ What is Nmap?
Nmap (Network Mapper) is a powerful open-source tool used for network discovery, security auditing, and vulnerability assessment.

---

## âœ… 1. Basic Host Discovery

### Find live hosts in a network:
```bash
nmap -sn 192.168.1.0/24
```
- `-sn` : Ping scan (no port scan).
  
---

## âœ… 2. Port Scanning

### Scan all ports of a target:
```bash
nmap -p- 192.168.1.100
```
- `-p-` : Scan all 65535 TCP ports.

### Scan common ports (default):
```bash
nmap 192.168.1.100
```

---

## âœ… 3. Service and Version Detection

### Detect running services and their versions:
```bash
nmap -sV 192.168.1.100
```
- `-sV` : Service version detection.

---

## âœ… 4. OS Detection

### Detect Operating System of the target:
```bash
nmap -O 192.168.1.100
```
- `-O` : OS detection.

### Aggressive scan (includes OS detection, service version detection, script scan, and traceroute):
```bash
nmap -A 192.168.1.100
```

---

## âœ… 5. Nmap Scripting Engine (NSE) â€“ Vulnerability Detection

### List available scripts:
```bash
ls /usr/share/nmap/scripts/
```

### Run vulnerability scan scripts:
```bash
nmap --script vuln 192.168.1.100
```
- `--script vuln`: Runs all vulnerability detection scripts.

### Scan specific vulnerability script (e.g., HTTP vulns):
```bash
nmap --script http-vuln* 192.168.1.100
```

### Run a specific script (e.g., Heartbleed vulnerability check):
```bash
nmap --script ssl-heartbleed -p 443 192.168.1.100
```

---

## âœ… 6. Example Advanced Vulnerability Scan Command

```bash
nmap -p 21,22,80,443,3306 --script vuln -sV -O -T4 192.168.1.100
```

- `-p 21,22,80,443,3306` : Scan specific ports.
- `--script vuln` : Run vulnerability scripts.
- `-sV` : Service version detection.
- `-O` : OS detection.
- `-T4` : Faster execution speed.

---

## âœ… 7. Output Options

### Save results in normal, XML, and grepable format:
```bash
nmap -oN scan.txt -oX scan.xml -oG scan.gnmap 192.168.1.100
```
- `-oN` : Normal output.
- `-oX` : XML output.
- `-oG` : Grepable output.

---

## âœ… 8. Timing and Performance

| Flag | Purpose |
|------|---------|
| `-T0` | Paranoid (slowest) |
| `-T1` | Sneaky |
| `-T2` | Polite |
| `-T3` | Normal (default) |
| `-T4` | Aggressive (faster) |
| `-T5` | Insane (very fast, may be detected) |

Example:
```bash
nmap -T4 -p 80,443 --script vuln 192.168.1.100
```

---

## âœ… 9. UDP Vulnerability Scanning

```bash
nmap -sU -p 53,123,161 --script vuln 192.168.1.100
```

- `-sU`: Perform UDP scan.
- Ports: DNS (53), NTP (123), SNMP (161).

---

## âœ… 10. Example: Full Command for Vulnerability Assessment

```bash
nmap -sS -sU -p T:21,22,80,443,U:53,161 --script vuln -O -sV -oA full_scan 192.168.1.100
```

- `-sS`: TCP SYN scan.
- `-sU`: UDP scan.
- `-p T:... U:...`: TCP and UDP ports.
- `--script vuln`: Run vulnerability scripts.
- `-O`: OS detection.
- `-sV`: Service version detection.
- `-oA full_scan`: Saves in all three formats with prefix `full_scan`.

---

## âš¡ Tips and Best Practices

- Always run scans with proper authorization.
- Prefer targeted scans over network-wide scans in production.
- Use `-Pn` if ICMP is blocked (skip host discovery):
  ```bash
  nmap -Pn --script vuln 192.168.1.100
  ```
- Combine with tools like `grep` or `awk` to parse results.

---

## âœ… References

- Official Nmap Documentation: https://nmap.org/docs.html
- Nmap Scripting Engine Docs: https://nmap.org/book/nse.html
